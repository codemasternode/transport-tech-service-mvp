{"version":3,"sources":["../../src/controllers/contact.js"],"names":["contactToUs","req","res","requireContactProperties","i","length","body","status","send","msg","name","surname","email","taxNumber","description","companyName","topic","then","result","to","subject","html","text","err","console","log","contactToCompany","undefined","phone","startTime","fullCost","weight","height","width","numberOfPalettes","typeOfPalette","companyEmail","vehicles","points","isDimensions","generatedURL","lat","lng","substring","urlRoute"],"mappings":"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","sourcesContent":["import { loadTemplate, sendEmail } from \"../config/mailer\";\n\nexport async function contactToUs(req, res) {\n  const requireContactProperties = [\n    \"name\",\n    \"surname\",\n    \"email\",\n    \"description\",\n    \"topic\"\n  ];\n\n  for (let i = 0; i < requireContactProperties.length; i++) {\n    if (\n      !req.body[requireContactProperties[i]] ||\n      req.body[requireContactProperties[i]].length === 0\n    ) {\n      return res.status(400).send({\n        msg: `Missing ${requireContactProperties[i]} property`\n      });\n    }\n  }\n\n  let { name, surname, email, taxNumber, description, companyName, topic } = req.body;\n  if (!taxNumber) {\n    taxNumber = \"Brak\"\n  }\n  if (!companyName) {\n    companyName = \"Brak\"\n  }\n  loadTemplate(\"contactToUs\", [\n    { name, surname, email, taxNumber, description, companyName, topic }\n  ])\n    .then(result => {\n      sendEmail({\n        to: \"marcinwarzybok@outlook.com\",\n        subject: `New Customer ${name} ${surname}`,\n        html: result[0].email.html,\n        text: result[0].email.text\n      });\n    })\n    .catch(err => {\n      console.log(err);\n    });\n  res.send({});\n}\n\nexport async function contactToCompany(req, res) {\n  const requireContactProperties = [\n    \"name\",\n    \"surname\",\n    \"email\",\n    \"phone\",\n    \"startTime\",\n    \"fullCost\",\n    \"weight\",\n    \"height\",\n    \"description\",\n    \"companyEmail\",\n    \"vehicles\",\n    \"points\",\n    \"isDimensions\"\n  ];\n\n  for (let i = 0; i < requireContactProperties.length; i++) {\n    if (req.body[requireContactProperties[i]] === undefined) {\n      return res.status(400).send({\n        msg: `Missing ${requireContactProperties[i]} property`\n      });\n    }\n  }\n\n  let {\n    name,\n    surname,\n    email,\n    phone,\n    startTime,\n    companyName,\n    taxNumber,\n    fullCost,\n    weight,\n    height,\n    width,\n    length,\n    numberOfPalettes,\n    typeOfPalette,\n    description,\n    companyEmail,\n    vehicles,\n    points,\n    isDimensions\n  } = req.body;\n\n  let generatedURL = \"https://www.google.com/maps/dir/?api=1&\";\n  for (let i = 0; i < points.length; i++) {\n    if (i === 0) {\n      generatedURL += `origin=${points[i].lat},${points[i].lng}&waypoints=`;\n    } else if (i === points.length - 1) {\n      generatedURL = generatedURL.substring(0, generatedURL.length - 1);\n      generatedURL += `&destination=${points[i].lat},${points[i].lng}`;\n    } else {\n      generatedURL += `${points[i].lat},${points[i].lng}|`;\n    }\n  }\n  generatedURL += \"&travelmode=driving\"\n  console.log(generatedURL);\n  if (!taxNumber) {\n    taxNumber = \"-\"\n  }\n  if (!companyName) {\n    companyName = \"-\"\n  }\n  loadTemplate(\"contactToCompany\", [\n    {\n      name,\n      surname,\n      email,\n      phone,\n      startTime,\n      companyName,\n      taxNumber,\n      fullCost,\n      weight,\n      height,\n      width,\n      length,\n      numberOfPalettes,\n      typeOfPalette,\n      description,\n      vehicles,\n      points,\n      isDimensions,\n      urlRoute: generatedURL\n    }\n  ])\n    .then(result => {\n      sendEmail({\n        to: companyEmail,\n        subject: `New Customer ${name} ${surname}`,\n        html: result[0].email.html,\n        text: result[0].email.text\n      });\n    })\n    .catch(err => {\n      console.log(err);\n    });\n  res.send({});\n}\n"],"file":"contact.js"}